"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[313],{1313:(mr,v,a)=>{a.r(v),a.d(v,{AuthModule:()=>sr});var l=a(89),q=a(2355),R=a(7513),F=a(3058),U=a(7250),y=a(7455),m=a(2369),f=a(2074),h=a(1300),i=a(6652),u=a(6789),r=a(4355),N=a(7969),d=a(8987);const E=()=>{const t=(0,r.f3M)(d.K),e=(0,r.f3M)(u.F0);return t.isAuthorized$.pipe((0,N.U)(o=>!o||e.parseUrl("/auth/login")))};var x=a(7881),Z=a(447),_=a(3568),A=a(3787);function C(t){return e=>e.pipe((0,_.K)(o=>(o instanceof Z.k&&function J(t,e){Object.keys(t.controls).forEach(n=>{const s=e[n],T=t.controls[n];s&&T&&T.setErrors({invalid:s})})}(t,o.validationData),(0,A._)(()=>o))))}var p,t,g=a(4121),L=a(4707),M=a(2519);(t=p||(p={})).matchControl=function e(n){return s=>s.parent?.get(n)?.value!==s.value?{matchError:!0}:null},t.convertTypeToMessage=function o(n,s){return{required:`${s??"Field"} is required`,email:"Email is incorrect",minlength:`${s} should contain minimum 8 symbols`,matchError:`${s} do not match`}[n]};let I=(()=>{class t{transform(o,n){return p.convertTypeToMessage(n,o)}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275pipe=r.Yjl({name:"errorMessage",type:t,pure:!0}),t})();function j(t,e){if(1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.qZA()),2&t){const o=e.ngIf;r.xp6(1),r.hij(" ",o," ")}}function P(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Email","email")," "))}function S(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Email","required")," "))}function w(t,e){if(1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.qZA()),2&t){const o=e.ngIf;r.xp6(1),r.hij(" ",o," ")}}function O(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Password","required")," "))}function Y(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Password","minlength")," "))}function b(t,e){if(1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.qZA()),2&t){const o=e.ngIf;r.xp6(1),r.hij(" ",o," ")}}function Q(t,e){1&t&&(r.TgZ(0,"div",12),r._UZ(1,"camp-spinner"),r.qZA())}let $=(()=>{class t{constructor(){this.isLoading$=new g.X(!1),this.commonErrors$=new g.X(""),this.formBuilder=(0,r.f3M)(i.j3),this.userService=(0,r.f3M)(d.K),this.destroyRef=(0,r.f3M)(r.ktI),this.router=(0,r.f3M)(u.F0),this.loginForm=this.initLoginForm()}onSubmit(){this.loginForm.markAllAsTouched(),!this.loginForm.invalid&&(this.isLoading$.next(!0),this.userService.login(this.loginForm.getRawValue()).pipe(C(this.loginForm),(0,_.K)(o=>(o instanceof Z.k&&null!=o.validationData.nonFieldErrors&&this.commonErrors$.next(o.validationData.nonFieldErrors),(0,A._)(()=>o))),(0,L.f)(this.isLoading$),(0,x.sL)(this.destroyRef)).subscribe(()=>{this.router.navigate(["/"])}))}hasRequiredError(o){return!!this.loginForm.contains(o)&&this.loginForm.controls[o].hasError("required")}get hasPasswordMinLengthError(){return this.loginForm.controls.password.hasError("minlength")}get isEmailValid(){return this.loginForm.controls.email.hasError("email")}hasServerError(o){return!!this.loginForm.contains(o)&&this.loginForm.controls[o].getError("invalid")}initLoginForm(){return this.formBuilder.group({email:this.formBuilder.control("",[i.kI.required,i.kI.email]),password:this.formBuilder.control("",[i.kI.required,i.kI.minLength(8)])})}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=r.Xpm({type:t,selectors:[["camp-login"]],decls:29,vars:13,consts:[[1,"auth-container"],[1,"auth-title"],[1,"auth-common-errors-container"],[4,"ngIf"],[1,"auth-form",3,"formGroup","ngSubmit"],["color","accent"],["formControlName","email","matInput",""],["type","password","formControlName","password","matInput",""],["type","submit","mat-raised-button","","color","primary",1,"auth-submit"],["routerLink","/auth/register",1,"auth-link"],["routerLink","/animes",1,"auth-link"],["class","auth-spinner",4,"ngIf"],[1,"auth-spinner"]],template:function(o,n){1&o&&(r.TgZ(0,"div",0)(1,"h1",1),r._uU(2,"Login"),r.qZA(),r.TgZ(3,"div",2),r.YNc(4,j,2,1,"mat-error",3),r.ALo(5,"async"),r.qZA(),r.TgZ(6,"form",4),r.NdJ("ngSubmit",function(){return n.onSubmit()}),r.TgZ(7,"mat-form-field",5)(8,"mat-label",5),r._uU(9,"Email"),r.qZA(),r._UZ(10,"input",6),r.YNc(11,P,3,4,"mat-error",3),r.YNc(12,S,3,4,"mat-error",3),r.YNc(13,w,2,1,"mat-error",3),r.qZA(),r.TgZ(14,"mat-form-field",5)(15,"mat-label",5),r._uU(16,"Password"),r.qZA(),r._UZ(17,"input",7),r.YNc(18,O,3,4,"mat-error",3),r.YNc(19,Y,3,4,"mat-error",3),r.YNc(20,b,2,1,"mat-error",3),r.qZA(),r.TgZ(21,"button",8),r._uU(22,"Login"),r.qZA()(),r.TgZ(23,"a",9),r._uU(24,"Do not have an account yet?"),r.qZA(),r.TgZ(25,"a",10),r._uU(26,"Go to main page"),r.qZA(),r.YNc(27,Q,2,0,"div",11),r.ALo(28,"async"),r.qZA()),2&o&&(r.xp6(4),r.Q6J("ngIf",r.lcZ(5,9,n.commonErrors$)),r.xp6(2),r.Q6J("formGroup",n.loginForm),r.xp6(5),r.Q6J("ngIf",n.isEmailValid),r.xp6(1),r.Q6J("ngIf",n.hasRequiredError("email")),r.xp6(1),r.Q6J("ngIf",n.hasServerError("email")),r.xp6(5),r.Q6J("ngIf",n.hasRequiredError("password")),r.xp6(1),r.Q6J("ngIf",n.hasPasswordMinLengthError),r.xp6(1),r.Q6J("ngIf",n.hasServerError("password")),r.xp6(7),r.Q6J("ngIf",r.lcZ(28,11,n.isLoading$)))},dependencies:[i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,u.rH,l.O5,M.O,m.KE,m.hX,m.TO,f.Nt,h.lW,l.Ov,I],styles:[".auth-container[_ngcontent-%COMP%]{display:flex;height:100vh;flex-direction:column;justify-content:center;align-items:center}.auth-form[_ngcontent-%COMP%]{width:450px;display:flex;flex-direction:column}.auth-title[_ngcontent-%COMP%]{text-align:center;font-size:40px;margin-bottom:var(--space-lg)}.auth-spinner[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;z-index:100;background-color:var(--spinner-background-color)}.auth-submit[_ngcontent-%COMP%]{margin-bottom:var(--space-sm)}.auth-link[_ngcontent-%COMP%]{text-decoration:none;color:var(--primary-contrast-color)}.auth-common-errors-container[_ngcontent-%COMP%]{margin-bottom:var(--space-md)}"]}),t})();function B(t,e){if(1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.qZA()),2&t){const o=e.ngIf;r.xp6(1),r.hij(" ",o," ")}}function k(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Email","required")," "))}function G(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Email","email")," "))}function K(t,e){if(1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.qZA()),2&t){const o=e.ngIf;r.xp6(1),r.hij(" ",o," ")}}function X(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"First name","required")," "))}function z(t,e){if(1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.qZA()),2&t){const o=e.ngIf;r.xp6(1),r.hij(" ",o," ")}}function D(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Last name","required")," "))}function V(t,e){if(1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.qZA()),2&t){const o=e.ngIf;r.xp6(1),r.hij(" ",o," ")}}function W(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Password","minlength")," "))}function H(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Password","required")," "))}function rr(t,e){if(1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.qZA()),2&t){const o=e.ngIf;r.xp6(1),r.hij(" ",o," ")}}function tr(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Repeated password","minlength")," "))}function or(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Repeated password","required")," "))}function er(t,e){1&t&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"errorMessage"),r.qZA()),2&t&&(r.xp6(1),r.hij(" ",r.xi3(2,1,"Passwords","matchError")," "))}function nr(t,e){1&t&&(r.TgZ(0,"div",15),r._UZ(1,"camp-spinner"),r.qZA())}const ir=[{path:"login",component:$,canActivate:[E]},{path:"register",component:(()=>{class t{constructor(){this.isLoading$=new g.X(!1),this.commonErrors$=new g.X(""),this.formBuilder=(0,r.f3M)(i.j3),this.userService=(0,r.f3M)(d.K),this.destroyRef=(0,r.f3M)(r.ktI),this.router=(0,r.f3M)(u.F0),this.registrationForm=this.initRegisterForm()}onSubmit(){this.registrationForm.markAllAsTouched(),!this.registrationForm.invalid&&(this.isLoading$.next(!0),this.userService.register(this.registrationForm.getRawValue()).pipe(C(this.registrationForm),(0,_.K)(o=>(o instanceof Z.k&&null!=o.validationData.nonFieldErrors&&this.commonErrors$.next(o.validationData.nonFieldErrors),(0,A._)(()=>o))),(0,L.f)(this.isLoading$),(0,x.sL)(this.destroyRef)).subscribe(()=>{this.router.navigate(["/"])}))}hasRequiredError(o){return!!this.registrationForm.contains(o)&&this.registrationForm.controls[o].hasError("required")}hasMinLengthError(o){return!!this.registrationForm.contains(o)&&this.registrationForm.controls[o].hasError("minlength")}get isEmailValid(){return this.registrationForm.controls.email.hasError("email")}get hasPasswordMatch(){return this.registrationForm.controls.repeatPassword.hasError("matchError")}hasServerError(o){return!!this.registrationForm.contains(o)&&this.registrationForm.controls[o].getError("invalid")}initRegisterForm(){return this.formBuilder.group({email:this.formBuilder.control("",[i.kI.required,i.kI.email]),firstName:this.formBuilder.control("",[i.kI.required]),lastName:this.formBuilder.control("",[i.kI.required]),password:this.formBuilder.control("",[i.kI.required,i.kI.minLength(8)]),repeatPassword:this.formBuilder.control("",[i.kI.required,i.kI.minLength(8),p.matchControl("password")])})}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=r.Xpm({type:t,selectors:[["camp-login"]],decls:48,vars:20,consts:[[1,"auth-container"],[1,"auth-title"],[1,"auth-common-errors-container"],[4,"ngIf"],[1,"auth-form",3,"formGroup","ngSubmit"],["color","accent"],["formControlName","email","matInput",""],["formControlName","firstName","matInput",""],["formControlName","lastName","matInput",""],["type","password","formControlName","password","matInput",""],["type","password","formControlName","repeatPassword","matInput",""],["type","submit","mat-raised-button","","color","primary",1,"auth-submit"],["routerLink","/auth/login","href","",1,"auth-link"],["routerLink","/animes",1,"auth-link"],["class","auth-spinner",4,"ngIf"],[1,"auth-spinner"]],template:function(o,n){1&o&&(r.TgZ(0,"div",0)(1,"h1",1),r._uU(2,"Register"),r.qZA(),r.TgZ(3,"div",2),r.YNc(4,B,2,1,"mat-error",3),r.ALo(5,"async"),r.qZA(),r.TgZ(6,"form",4),r.NdJ("ngSubmit",function(){return n.onSubmit()}),r.TgZ(7,"mat-form-field",5)(8,"mat-label",5),r._uU(9,"Email"),r.qZA(),r._UZ(10,"input",6),r.YNc(11,k,3,4,"mat-error",3),r.YNc(12,G,3,4,"mat-error",3),r.YNc(13,K,2,1,"mat-error",3),r.qZA(),r.TgZ(14,"mat-form-field",5)(15,"mat-label",5),r._uU(16,"First name"),r.qZA(),r._UZ(17,"input",7),r.YNc(18,X,3,4,"mat-error",3),r.YNc(19,z,2,1,"mat-error",3),r.qZA(),r.TgZ(20,"mat-form-field",5)(21,"mat-label",5),r._uU(22,"Last name"),r.qZA(),r._UZ(23,"input",8),r.YNc(24,D,3,4,"mat-error",3),r.YNc(25,V,2,1,"mat-error",3),r.qZA(),r.TgZ(26,"mat-form-field",5)(27,"mat-label",5),r._uU(28,"Password"),r.qZA(),r._UZ(29,"input",9),r.YNc(30,W,3,4,"mat-error",3),r.YNc(31,H,3,4,"mat-error",3),r.YNc(32,rr,2,1,"mat-error",3),r.qZA(),r.TgZ(33,"mat-form-field",5)(34,"mat-label",5),r._uU(35,"Repeat password"),r.qZA(),r._UZ(36,"input",10),r.YNc(37,tr,3,4,"mat-error",3),r.YNc(38,or,3,4,"mat-error",3),r.YNc(39,er,3,4,"mat-error",3),r.qZA(),r.TgZ(40,"button",11),r._uU(41,"Register"),r.qZA()(),r.TgZ(42,"a",12),r._uU(43,"Already have an account?"),r.qZA(),r.TgZ(44,"a",13),r._uU(45,"Go to main page"),r.qZA(),r.YNc(46,nr,2,0,"div",14),r.ALo(47,"async"),r.qZA()),2&o&&(r.xp6(4),r.Q6J("ngIf",r.lcZ(5,16,n.commonErrors$)),r.xp6(2),r.Q6J("formGroup",n.registrationForm),r.xp6(5),r.Q6J("ngIf",n.hasRequiredError("email")),r.xp6(1),r.Q6J("ngIf",n.isEmailValid),r.xp6(1),r.Q6J("ngIf",n.hasServerError("email")),r.xp6(5),r.Q6J("ngIf",n.hasRequiredError("firstName")),r.xp6(1),r.Q6J("ngIf",n.hasServerError("firstName")),r.xp6(5),r.Q6J("ngIf",n.hasRequiredError("lastName")),r.xp6(1),r.Q6J("ngIf",n.hasServerError("lastName")),r.xp6(5),r.Q6J("ngIf",n.hasMinLengthError("password")),r.xp6(1),r.Q6J("ngIf",n.hasRequiredError("password")),r.xp6(1),r.Q6J("ngIf",n.hasServerError("password")),r.xp6(5),r.Q6J("ngIf",n.hasMinLengthError("repeatPassword")),r.xp6(1),r.Q6J("ngIf",n.hasRequiredError("repeatPassword")),r.xp6(1),r.Q6J("ngIf",n.hasPasswordMatch),r.xp6(7),r.Q6J("ngIf",r.lcZ(47,18,n.isLoading$)))},dependencies:[i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,u.rH,l.O5,M.O,m.KE,m.hX,m.TO,f.Nt,h.lW,l.Ov,I],styles:[".auth-container[_ngcontent-%COMP%]{display:flex;height:100vh;flex-direction:column;justify-content:center;align-items:center}.auth-form[_ngcontent-%COMP%]{width:450px;display:flex;flex-direction:column}.auth-title[_ngcontent-%COMP%]{text-align:center;font-size:40px;margin-bottom:var(--space-lg)}.auth-spinner[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;z-index:100;background-color:var(--spinner-background-color)}.auth-submit[_ngcontent-%COMP%]{margin-bottom:var(--space-sm)}.auth-link[_ngcontent-%COMP%]{text-decoration:none;color:var(--primary-contrast-color)}.auth-common-errors-container[_ngcontent-%COMP%]{margin-bottom:var(--space-md)}"]}),t})(),canActivate:[E]}];let ar=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[u.Bz.forChild(ir),u.Bz]}),t})(),sr=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[i.UX,l.ez,q.m,R.p0,F.Cq,U.JX,y.TU,m.lN,f.c,h.ot,ar]}),t})()}}]);